# Set wd
setwd("~/GitHub/VirosporeQuant")
# Load data
virospore_MOI <- read.csv("~/GitHub/VirosporeQuant/Data/ddPCR_Quant/20250306_SPO1_Delta6_MOI_ddPCR.csv")
# Load data
virospore_MOI <- read.csv("~/GitHub/VirosporeQuant/Data/ddPCR_Quant/20250306_SPO1_Delta6_MOI_ddPCR.csv")
# Set wd
setwd("~/GitHub/VirosporeQuant/ddPCR_MOI_virospore_quant")
# Load data
virospore_MOI <- read.csv("~/GitHub/VirosporeQuant/Data/ddPCR_MOI_virospore_quant/Data/20250306_SPO1_Delta6_MOI_ddPCR.csv")
# Load data
virospore_MOI <- read.csv("~/GitHub/VirosporeQuant/ddPCR_MOI_virospore_quant/Data/20250306_SPO1_Delta6_MOI_ddPCR.csv")
# Calculate entrapment efficiency for each replicate sample
virospore_MOI$Entrapment_Efficiency <- (virospore_MOI$SPO1_Copy_copies_ul / virospore_MOI$Bacillus_Copy) * 100
# Load libraries
library(dunn.test)
# Stats comparing entrapment efficieny at different MOI
# Check normality
shapiro.test(virospore_MOI$Entrapment_Efficiency) # based on this the data is not normally distributed
# Perform Kruskal-Wallis because the data is not normally distributed
kruskal.test(Entrapment_Efficiency ~ factor(MOI), data = virospore_MOI)
# Post-hoc for Kruskal
dunn.test(virospore_MOI$Entrapment_Efficiency, virospore_MOI$MOI, method = "bonferroni")
# testing for correlation?
cor.test(virospore_MOI$MOI, virospore_MOI$Entrapment_Efficiency, method = "spearman")  # Use Spearman for non-linear relationships
# Visualize entrapment efficiency via box plot
ggplot(virospore_MOI, aes(x = factor(MOI), y = Entrapment_Efficiency, fill = factor(MOI))) +
geom_boxplot(alpha = 0.6) +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +  # Show individual replicates
theme_minimal() +
scale_y_log10() + # Log transform y axis
labs(y = "Entrapment Efficiency (%)", x = "MOI") +
theme(legend.position = "none")
View(virospore_MOI)
# Bar plot
library(ggplot2)
library(dplyr)
# Calculate mean and standard error for each MOI
summary_stats <- virospore_MOI %>%
group_by(MOI) %>%
summarise(
mean = mean(Entrapment_Efficiency),
se = sd(Entrapment_Efficiency) / sqrt(n())  # Standard Error
)
# Bar plot
ggplot(summary_stats, aes(x = factor(MOI), y = mean)) +
geom_bar(stat = "identity", fill = "steelblue", color = "black", width = 0.6) +
geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +
scale_y_log10() +
theme_minimal() +
labs(y = "Mean Entrapment Efficiency (%)", x = "MOI") +
theme(text = element_text(size = 14))
View(summary_stats)
# Load OSG data
library(readxl)
OSG <- read_excel("~/GitHub/VirosporeQuant/Phage_OSG/Data/20250305_1447_OSG_spo1.xlsx", sheet = "SPO1_OSG")
# Visualize
library(ggplot2)
ggplot(OSG, aes(x = Time.min, y = SPO1.titer_PFU_mL)) +
geom_point() +
geom_line() +
scale_y_log10() +  # Log scale often helps with phage data
labs(x = "Time (min)", y = "Phage Concentration (PFU/mL)",
title = "Phage One-Step Growth Curve") +
theme_minimal()
# Renaming time column because I dont think that gcplyer likes "." in column names
library(dplyr)
OSG <- OSG %>%
rename(
Time = Time.min
)
# Working with gcplyr package
library(gcplyr)
library(dplyr)
# Smooth the data
OSG <- OSG %>%
mutate(Smoothed_Phage = smooth_data(x = Time, y = SPO1.titer_PFU_mL,
sm_method = "loess", window_width_n = 5))
# Calculate derivatives
OSG <- OSG %>%
mutate(Deriv_Phage = calc_deriv(x = Time, y = Smoothed_Phage,
percapita = TRUE, blank = 0,
window_width_n = 5))
# Extract parms
latent_period <- OSG %>%
filter(Deriv_Phage > 0.1 * max(Deriv_Phage, na.rm = TRUE)) %>%
summarise(Latent = min(Time)) %>%
pull(Latent)
burst_size <- max(OSG$Smoothed_Phage) / min(OSG$Smoothed_Phage)
# Print results
cat("Latent Period:", latent_period, "min\n")
cat("Burst Size:", burst_size, "\n")
# Plot
ggplot(OSG, aes(x = Time)) +
geom_point(aes(y = SPO1.titer_PFU_mL), color = "black", alpha = 0.5) +
geom_smooth(aes(y = Smoothed_Phage), color = "blue") +
geom_vline(xintercept = latent_period, linetype = "dashed", color = "red") +
scale_y_log10() +
labs(x = "Time (min)", y = "Phage Concentration (PFU/mL)",
title = "Phage One-Step Growth Curve") +
scale_color_manual() +
theme_minimal()
library(ggplot2)
ggplot(OSG, aes(x = Time)) +
geom_point(aes(y = SPO1.titer_PFU_mL), color = "black", alpha = 0.5) +
geom_smooth(aes(y = Smoothed_Phage), color = "blue") +
geom_vline(xintercept = latent_period, linetype = "dashed", color = "red") +
scale_y_log10() +
labs(
x = "Time (min)",
y = "Phage Concentration (PFU/mL)",
title = "Phage Growth Curve"
) +
# Remove or customize this line only if you're mapping a variable to color in aes()
# scale_color_manual(values = c("some_category" = "blue", ...))
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12)
)
library(ggplot2)
ggplot(OSG, aes(x = Time)) +
geom_point(aes(y = SPO1.titer_PFU_mL), color = "black", alpha = 0.5) +
geom_smooth(aes(y = Smoothed_Phage), color = "blue") +
geom_vline(xintercept = latent_period, linetype = "dashed", color = "red") +
scale_y_log10() +
labs(
x = "Time (min)",
y = "Phage Concentration (PFU/mL)",
title = ""
) +
# Remove or customize this line only if you're mapping a variable to color in aes()
# scale_color_manual(values = c("some_category" = "blue", ...))
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12)
)
ggplot(OSG, aes(x = Time)) +
geom_point(aes(y = SPO1.titer_PFU_mL, color = "Observed"), alpha = 0.5) +
geom_smooth(aes(y = Smoothed_Phage, color = "Smoothed")) +
geom_vline(aes(xintercept = latent_period, color = "Latent period"), linetype = "dashed") +
scale_y_log10() +
labs(x = "Time (min)", y = "Phage Concentration (PFU/mL)",
title = "Phage SPO1 One-Step Growth Curve", color = "") +
scale_color_manual(values = c("Observed" = "black",
"Smoothed" = "blue",
"Latent period" = "red")) +
theme_minimal() +
theme(
plot.title = element_text(size = 12),   # Title size
axis.title = element_text(size = 12),                 # Axis labels size
axis.text = element_text(size = 12),                  # Tick mark labels size
legend.title = element_text(size = 12),               # Legend title size
legend.text = element_text(size = 12)                 # Legend labels size
)
ggplot(OSG, aes(x = Time)) +
geom_point(aes(y = SPO1.titer_PFU_mL, color = "Observed"), alpha = 0.5) +
geom_smooth(aes(y = Smoothed_Phage, color = "Smoothed")) +
geom_vline(aes(xintercept = latent_period, color = "Latent period"), linetype = "dashed") +
scale_y_log10() +
labs(x = "Time (min)", y = "Phage Concentration (PFU/mL)",
title = "", color = "") +
scale_color_manual(values = c("Observed" = "black",
"Smoothed" = "blue",
"Latent period" = "red")) +
theme_minimal() +
theme(
plot.title = element_text(size = 12),   # Title size
axis.title = element_text(size = 14),                 # Axis labels size
axis.text = element_text(size = 14),                  # Tick mark labels size
legend.title = element_text(size = 14),               # Legend title size
legend.text = element_text(size = 14)                 # Legend labels size
)
t"
# Load data
virospore_MOI <- read.csv("~/GitHub/VirosporeQuant/ddPCR_MOI_virospore_quant/Data/20250306_SPO1_Delta6_MOI_ddPCR.csv")
# Set wd
setwd("~/GitHub/VirosporeQuant/ddPCR_MOI_virospore_quant")
# Load data
virospore_MOI <- read.csv("~/GitHub/VirosporeQuant/ddPCR_MOI_virospore_quant/Data/20250306_SPO1_Delta6_MOI_ddPCR.csv")
# Calculate entrapment efficiency for each replicate sample
virospore_MOI$Entrapment_Efficiency <- (virospore_MOI$SPO1_Copy_copies_ul / virospore_MOI$Bacillus_Copy) * 100
# Load libraries
library(dunn.test)
install.packages("dunn.test")
# Load libraries
library(dunn.test)
# Stats comparing entrapment efficieny at different MOI
# Check normality
shapiro.test(virospore_MOI$Entrapment_Efficiency) # based on this the data is not normally distributed
# Perform Kruskal-Wallis because the data is not normally distributed
kruskal.test(Entrapment_Efficiency ~ factor(MOI), data = virospore_MOI)
# Post-hoc for Kruskal
dunn.test(virospore_MOI$Entrapment_Efficiency, virospore_MOI$MOI, method = "bonferroni")
library(ggpubr)
ggplot(virospore_MOI, aes(x = factor(MOI), y = Entrapment_Efficiency)) +
geom_boxplot() +
stat_compare_means(method = "kruskal.test") +
stat_compare_means(comparisons = list(c("0.001", "0.01")),
method = "dunn.test",
label = "p.signif")
install.packages(("ggpubr")
)
library(ggpubr)
ggplot(virospore_MOI, aes(x = factor(MOI), y = Entrapment_Efficiency)) +
geom_boxplot() +
stat_compare_means(method = "kruskal.test") +
stat_compare_means(comparisons = list(c("0.001", "0.01")),
method = "dunn.test",
label = "p.signif")
library(ggpubr)
ggplot(virospore_MOI, aes(x = factor(MOI), y = Entrapment_Efficiency)) +
geom_boxplot() +
stat_compare_means(method = "kruskal.test") +
stat_compare_means(comparisons = list(c("0.001", "0.01")),
method = "dunn.test",
label = "p.signif")
# testing for correlation?
cor.test(virospore_MOI$MOI, virospore_MOI$Entrapment_Efficiency, method = "spearman")  # Use Spearman for non-linear relationships
ggplot(virospore_MOI, aes(x = factor(MOI), y = Entrapment_Efficiency, fill = factor(MOI))) +
geom_boxplot(alpha = 0.6) +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +  # Show individual replicates
theme_minimal() +
scale_y_log10() + # Log transform y axis
labs(y = "Entrapment Efficiency (%)", x = "MOI") +
theme(legend.position = "none")
library(ggplot2)
library(dplyr)
# Calculate mean and standard error for each MOI
summary_stats <- virospore_MOI %>%
group_by(MOI) %>%
summarise(
mean = mean(Entrapment_Efficiency),
se = sd(Entrapment_Efficiency) / sqrt(n())  # Standard Error
)
ggplot(summary_stats, aes(x = factor(MOI), y = mean)) +
geom_bar(stat = "identity", fill = "steelblue", color = "black", width = 0.6) +
#geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +
stat_compare_means(method = "kruskal.test") +
stat_compare_means(comparisons = list(c("0.001", "0.01")),
method = "dunn.test",
label = "p.signif")
library(ggplot2)
library(ggpubr)
ggplot(summary_stats, aes(x = factor(MOI), y = mean)) +
geom_bar(stat = "identity", fill = "steelblue", color = "black", width = 0.6) +
# Add error bars if you want:
# geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +
#
#stat_compare_means(comparisons = list(c("0.001", "0.01")),
#method = "t.test",
#label = "p.signif") +
scale_y_log10() +  # <--- you were missing this plus sign!
theme_classic() +
labs(y = "Mean Entrapment Efficiency (%)", x = "MOI") +
theme(text = element_text(size = 14))
ggplot(summary_stats, aes(x = factor(MOI), y = mean)) +
geom_bar(stat = "identity", fill = "steelblue", color = "black", width = 0.6) +
scale_y_log10() +
geom_signif(comparisons = list(c("0.001", "0.01")),
annotations = "*", y_position = 10.75, tip_length = 0.03) +
theme_classic() +
labs(y = "Mean Entrapment Efficiency (%)", x = "MOI") +
theme(text = element_text(size = 14))
virospore_MOI$Entrapment_Efficiency
