limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, by = 1),
labels = scales::label_scientific()
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(position = position_jitter(height = 0.05), alpha = 0.6) +
geom_smooth(method = "glm",
method.args = list(family = poisson()),  # or binomial() ifproportions
se = TRUE,
color = "blue") +
labs(
title = "",
x = "MOI",
y = "Entrapment Efficiency (%)"
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, by = 1),
labels = scales::label_scientific()
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(data = newdat, aes(y = fit), color = "blue", linewidth = 1.2) +
geom_ribbon(data = newdat, aes(ymin = lwr, ymax = upr), alpha = 0.2, fill = "blue") +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(position = position_jitter(height = 0.05), alpha = 0.6) +
geom_smooth(method = "glm",
method.args = list(family = poisson()),  # or binomial() ifproportions
se = TRUE,
color = "blue") +
labs(
title = "",
x = "MOI",
y = "Entrapment Efficiency (%)"
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, by = 1),
labels = scales::label_scientific()
)
# Linear model
library(dplyr)
library(ggplot2)
# Plot with regression lines by MOI
ggplot(d, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_smooth(method = "lm", se = TRUE, linetype = "solid", size = 1, colour = "black") +
geom_point(shape = 1, size = 3) +
labs(
title = "",
x = "MOI",
y = "Entrapment Efficiency (%)"
) +
labs(
title = "",
x = "MOI",
y = "Entrapment Efficiency (%)"
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, by = 1),
labels = scales::label_scientific()
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(position = position_jitter(height = 0.05), alpha = 0.6) +
geom_smooth(method = "glm",
method.args = list(family = poisson()),  # or binomial() ifproportions
se = TRUE,
color = "blue") +
labs(
title = "",
x = "MOI",
y = "Entrapment Efficiency (%)"
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, by = 1),
labels = scales::label_scientific()
)
# Plotting this model, creating predictions
# Generate a sequence of MOI values across your data range
newdat <- data.frame(
MOI = seq(min(virospore_MOI$MOI, na.rm = TRUE),
max(virospore_MOI$MOI, na.rm = TRUE),
length.out = 100)
)
# Predict on the link (log) scale, include SEs
pred <- predict(gm, newdata = newdat, type = "link", se.fit = TRUE)
# Convert back to the response (original) scale
newdat <- cbind(newdat, pred)
newdat <- newdat |>
dplyr::mutate(
fit = exp(fit),
lwr = exp(fit - 1.96 * se.fit),
upr = exp(fit + 1.96 * se.fit)
)
library(ggplot2)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(data = newdat, aes(y = fit), color = "blue", linewidth = 1.2) +
geom_ribbon(data = newdat, aes(ymin = lwr, ymax = upr), alpha = 0.2, fill = "blue") +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
View(newdat)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
scale_y_log10() +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
scale_y_log10() +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
scale_y_log10() +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
AIC(lm.model)
BIC(lm.model)
AIC(gm)
BIC(gm)
AIC(lm.model, gm)
BIC(lm.model, gm)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
scale_y_log10() +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(data = newdat, aes(y = fit), color = "blue", linewidth = 1.2) +
geom_ribbon(data = newdat, aes(ymin = lwr, ymax = upr), alpha = 0.2, fill = "blue") +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = lwr, ymax = upr),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
# scale_x_log10(
#   limits = c(1e-5, 10),
#   breaks = 10^seq(-5, 1, 1),
#   labels = scales::label_scientific()
#) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
View(newdat)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 100),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
# scale_x_log10(
#   limits = c(1e-5, 10),
#   breaks = 10^seq(-5, 1, 1),
#   labels = scales::label_scientific()
#) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 100),
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 100),
alpha = 0.2,
fill = "gray",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 100),
alpha = 0.2,
fill = "gray",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
# Plotting gamma
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 120),
alpha = 0.2,
fill = "gray",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
plot(gm)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 120),
alpha = 0.2,
fill = "gray",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM fit with log link"
)
ggplot(virospore_MOI, aes(x = MOI, y = Entrapment_Efficiency)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(
data = newdat,
aes(x = MOI, y = fit),
color = "blue",
linewidth = 1.2,
inherit.aes = FALSE
) +
geom_ribbon(
data = newdat,
aes(x = MOI, ymin = 0, ymax = 120),
alpha = 0.2,
fill = "gray",
inherit.aes = FALSE
) +
scale_x_log10(
limits = c(1e-5, 10),
breaks = 10^seq(-5, 1, 1),
labels = scales::label_scientific()
) +
labs(
x = "MOI",
y = "Entrapment Efficiency (%)",
title = "Gamma GLM"
)
