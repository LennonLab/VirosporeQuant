---
title: "Virospore annulus multi-quant"
author: "Joy O'Brien"
date: "2025-03-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr)
library(tidyr)  
library(vegan)
library(ggplot2)
library(mgcv)

# Things to do: create project for this, fork the Magalie repo and add to it, 
# Read data into 
viro_quant <- read_excel("~/GitHub/VirosporeQuant/Magalie_virospore_quant/Data/Annulus_Quant/20250311_annulus_multiquant_pilot.xlsx", sheet = "mutliquant_pilot")
```

```{r}
viro_quant$Distance_from_PFU_cm <- factor(viro_quant$Distance_from_PFU_cm)

# Boxplot of recovered VPFU by distance from PFU for fun
ggplot(viro_quant, aes(x = Distance_from_PFU_cm, y = VPFU, fill = Region)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Recovered VPFU by Distance from PFU", x = "Distance from PFU", y = "Recovered VPFU") +
  theme_minimal()
```
```{r}
library(ggplot2)
library(dplyr)

# Normalize the data to the area of the pipette tip (in cm) before calculating summary statistics (VPFU)
viro_quant$VPFU <- viro_quant$VPFU / 0.00785

str(viro_quant$Free_PFU)  # Should be "num"
viro_quant$Free_PFU <- as.numeric(viro_quant$Free_PFU)
viro_quant$Free_PFU <- viro_quant$Free_PFU / 0.00785


viro_quant$CFU <- viro_quant$CFU / 0.00785


```
```{r}
# Let's plot 
# Convert data to long format
viro_quant.long <- viro_quant %>%
  pivot_longer(cols = c(VPFU, Free_PFU, CFU), 
               names_to = "variable", 
               values_to = "value")

# Plot
ggplot(viro_quant.long, aes(x = Distance_from_PFU_cm, y = value, color = variable, group = variable)) +
  geom_line(linewidth = 1.2) +  
  geom_point(size = 2) + 
  scale_y_log10() +
  #facet_wrap(~ Region) +  
  scale_color_manual(values = c("coral", "cyan", "purple"), labels =c("Uninfected spores", "Free phage", "Virospores")) +  # Custom colors
  labs(title = "Virospores, Free phage, and uninfected spores vs Distance", 
       x = "Distance from PFU (cm)", y = "Virospores, Free phage , uninfected spores per cm^2", 
       color = "Measurement") 
```

