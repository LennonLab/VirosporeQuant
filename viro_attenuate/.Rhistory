geom_line() +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# Looks normal
# Check normality of time to lysis for infected treatment
shapiro.test(fluid_infected$time_to_lysis) # the data is not normally distributed
qqnorm(fluid_infected$time_to_lysis)
# Calculate kertosis
#install.packages("e1071")
# Load package
library(e1071)
# Calculate kurtosis
kurtosis_value <- kurtosis(fluid_infected$time_to_lysis)
print(kurtosis_value)
# View the updated data
head(fluid)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# Looks normal
# Check normality of time to lysis for infected treatment
shapiro.test(fluid_infected$time_to_lysis) # the data is not normally distributed
qqnorm(fluid_infected$time_to_lysis)
# Calculate kertosis
#install.packages("e1071")
# Load package
library(e1071)
# Calculate kurtosis
kurtosis_value <- kurtosis(fluid_infected$time_to_lysis)
print(kurtosis_value)
library(ggplot2)
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_histogram(aes(y = ..density..), binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Density") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# Looks normal
# Check normality of time to lysis for infected treatment
shapiro.test(fluid_infected$time_to_lysis) # the data is not normally distributed
qqnorm(fluid_infected$time_to_lysis)
# Calculate kertosis
#install.packages("e1071")
# Load package
library(e1071)
# Calculate kurtosis
kurtosis_value <- kurtosis(fluid_infected$time_to_lysis)
print(kurtosis_value)
library(ggplot2)
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_histogram(aes(y = ..density..), binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Density") +
theme_minimal() +
theme(text = element_text(size = 14))
qqnorm(fluid_infected$time_to_lysis, main = "Q-Q Plot of Time to Lysis")
qqline(fluid_infected$time_to_lysis, col = "red")
setwd("~/GitHub/viro.fluidics")
# Read in data
fluid <- read.csv("~/GitHub/viro.fluidics/data/fluidics.csv", header = TRUE, sep = ",", na.strings = "N/A")
# Remove inconclusive from spore fate
fluid <- fluid %>%
filter(spore.fate != "Inconclusive")
# Load libraries
library(ggplot2) # For plotting
library(dplyr)  # For filtering data
# Filter data for infected treatment
infected_data <- fluid %>% filter(treat == "infect")
# Filter data for uninfected treatment
control_data <- fluid %>% filter(treat == "control")
# Visualizing outcomes via boxplot
library(ggplot2)
library(dplyr)
# Summarize data: count occurrences of each outcome for each treatment
fluid_summary <- fluid %>%
group_by(treat, spore.fate) %>%
summarise(count = n(), .groups = "drop")
fluid_summary <- fluid_summary %>%
mutate(treat = recode(treat, "control" = "Uninfected", "infect" = "Infected"))
# Create a faceted bar plot
ggplot(fluid_summary, aes(x = spore.fate, y = count, fill = spore.fate)) +
geom_bar(stat = "identity", alpha = 0.8, color = "black") +
facet_wrap(~treat) +
theme_minimal() +
labs(title = "",
x = "Outcome",
y = "Count") +
scale_fill_manual(values = c("Lysed" = "#E63946", "Divided" = "#457B9D", "Stayed" = "#2A9D8F")) +
theme(text = element_text(size = 16),
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
# Let's look at the distribution of germination time in uninfected vs infected cells
library(ggplot2)
library(dplyr)
# Filter for the infected treatment
infected_data <- fluid %>% filter(treat == "infect")
# Plot histogram of germination time for infected cells
ggplot(infected_data, aes(x = germ.time)) +
geom_histogram(binwidth = 5, fill = "#E63946", color = "black", alpha = 0.7) +
theme_minimal() +
labs(title = "Distribution of Germination Time (Infected Treatment)",
x = "Germination Time",
y = "Frequency") +
theme(text = element_text(size = 14),
plot.title = element_text(hjust = 0.5, face = "bold"))
# Uninfected data
control_data <- fluid %>% filter(treat == "control")
ggplot(control_data, aes(x = germ.time)) +
geom_histogram(binwidth = 5, fill = "#E63946", color = "black", alpha = 0.7) +
theme_minimal() +
labs(title = "Distribution of Germination Time (Infected Treatment)",
x = "Germination Time",
y = "Frequency") +
theme(text = element_text(size = 14),
plot.title = element_text(hjust = 0.5, face = "bold"))
# Filter data for control and infected groups
control_data <- fluid %>% filter(treat == "control") %>% pull(germ.time)
infected_data <- fluid %>% filter(treat == "infect") %>% pull(germ.time)
# Check if the data is normally distributed
shapiro.test(control_data) # does not follow normal distribution
shapiro.test(infected_data) # does not follow normal distribution
# Since it is not normally distributed, need to use wilcoxon rank sum test
# Perform wilcoxon test
wilcox.test(germ.time ~ treat, data = fluid)
# There is no significant difference in germination time between infected and uninfected spores
library(ggplot2)
library(dplyr)
# Combine data into a dataframe
germ_data <- data.frame(
germ_time = c(control_data, infected_data),
treatment = rep(c("Uninfected", "Infected"), times = c(length(control_data), length(infected_data)))
)
# Filter out values ≤5 before plotting density
germ_data_filtered <- germ_data %>%
filter(germ_time > 5)
# Filter out values ≤5 before plotting density
germ_data_filtered <- germ_data %>%
filter(germ_time > 5)
# Plot histogram with transparency
ggplot(germ_data_filtered, aes(x = germ_time, fill = treatment, color = treatment)) +
geom_histogram(aes(y = ..density..), bins = 20, alpha = 0.2, position = "identity") +  # Lower alpha for transparency
geom_density(lwd = 1.2, alpha = 0.7) +  # Semi-transparent density curves
scale_fill_manual(values = c("Uninfected" = "#457B9D", "Infected" = "#E63946")) +
scale_color_manual(values = c("Uninfected" = "#457B9D", "Infected" = "#E63946")) +
labs(title = "Distribution of Germination Time by Treatment",
x = "Germination Time (min)",
y = "Density") +
theme_minimal() +
theme(text = element_text(size = 14),
plot.title = element_text(hjust = 0.5, face = "bold"))
library(ggplot2)
library(dplyr)
# Combine data into a dataframe
germ_data <- data.frame(
germ_time = c(control_data, infected_data),
treatment = rep(c("Uninfected", "Infected"), times = c(length(control_data), length(infected_data)))
)
# Filter out values ≤5 before plotting density
germ_data_filtered <- germ_data %>%
filter(germ_time > 5)
# Plot histograms side by side with facet_wrap
ggplot(germ_data_filtered, aes(x = germ_time, fill = treatment)) +
geom_histogram(aes(y = ..density..), bins = 20, alpha = 0.5, color = "black") +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
facet_wrap(~treatment) +  # Facet by treatment (side by side)
scale_fill_manual(values = c("Uninfected" = "#457B9D", "Infected" = "#E63946")) +
labs(title = "",
x = "Germination Time (min)",
y = "Density") +
theme_minimal() +
theme(text = element_text(size = 16),
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")  # Remove legend since facets label treatments
# Calculate time to lysis for infected treatment only and make a new dataset
fluid <- fluid %>%
mutate(time_to_lysis = ifelse(treat == "infect" & !is.na(lyse.time) & !is.na(germ.time),
lyse.time - germ.time, NA))
fluid_infected <- fluid %>%
filter(treat == "infect" & !is.na(lyse.time) & !is.na(germ.time)) %>%
mutate(time_to_lysis = lyse.time - germ.time)
# View the updated data
head(fluid)
head(fluid_infected)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
head(fluid_infected)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
head(fluid_infected)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "#2A9D8F", color = "black", alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
head(fluid_infected)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "#E63946", color = "black", alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
head(fluid_infected)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "#E63946", color = "black", alpha = 0.7) +
labs(title = "",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 14))
# View the updated data
head(fluid)
head(fluid_infected)
# Plot the histogram of time to lysis for the infected treatment
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_bar(binwidth = 1, fill = "#E63946", color = "black", alpha = 0.7) +
labs(title = "",
x = "Time to Lysis (minutes)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 16))
# Looks normal
# Check normality of time to lysis for infected treatment
shapiro.test(fluid_infected$time_to_lysis) # the data is not normally distributed
qqnorm(fluid_infected$time_to_lysis)
# Calculate kertosis
#install.packages("e1071")
# Load package
library(e1071)
# Calculate kurtosis
kurtosis_value <- kurtosis(fluid_infected$time_to_lysis)
print(kurtosis_value)
library(ggplot2)
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_histogram(aes(y = ..density..), binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Density") +
theme_minimal() +
theme(text = element_text(size = 14))
qqnorm(fluid_infected$time_to_lysis, main = "Q-Q Plot of Time to Lysis")
qqline(fluid_infected$time_to_lysis, col = "red")
# Looks normal
# Check normality of time to lysis for infected treatment
shapiro.test(fluid_infected$time_to_lysis) # the data is not normally distributed
# Calculate kertosis
#install.packages("e1071")
# Load package
library(e1071)
# Calculate kurtosis
kurtosis_value <- kurtosis(fluid_infected$time_to_lysis)
print(kurtosis_value)
library(ggplot2)
ggplot(fluid_infected, aes(x = time_to_lysis)) +
geom_histogram(aes(y = ..density..), binwidth = 1, fill = "red", color = "black", alpha = 0.7) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +
labs(title = "Time to Lysis After Germination (Infected)",
x = "Time to Lysis (minutes)",
y = "Density") +
theme_minimal() +
theme(text = element_text(size = 14))
qqnorm(fluid_infected$time_to_lysis, main = "Q-Q Plot of Time to Lysis")
qqline(fluid_infected$time_to_lysis, col = "red")
ggplot(fluid %>% filter(treat == "infect" & !is.na(time_to_lysis)), aes(x = time_to_lysis)) +
geom_histogram(binwidth = 1, fill = "#E63946", color = "black", alpha = 0.7) +  # Red color, black border
labs(
title = "Time to Lysis After Germination (Infected)",  # Title with improved font
x = "Time to Lysis (minutes)",  # x-axis label
y = "Frequency"  # y-axis label
) +
theme_minimal(base_size = 15) +  # Minimal theme with larger base text
theme(
text = element_text(size = 14),  # Text size
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),  # Center and bold title
axis.title = element_text(face = "bold"),  # Bold axis labels
axis.text = element_text(size = 12),  # Axis text size
panel.grid.major = element_line(color = "gray90", size = 0.5),  # Light gridlines for better visibility
panel.grid.minor = element_blank()  # Remove minor gridlines
)
# Histogram of lyse time
library(ggplot2)
library(dplyr)
# Subset lysis data
lysis_data <- fluid %>%
filter(treat == "infect", !is.na(lyse.time))
ggplot(lysis_data, aes(x = lyse.time)) +
geom_histogram(bins = 20, fill = "#E63946", color = "black", alpha = 0.5) +
geom_density(color = "black", lwd = 1.2, alpha = 0.7) +  # Overlay density curve
labs(title = "",
x = "Lysis Time (min)",
y = "Frequency") +
theme_minimal() +
theme(text = element_text(size = 16),
plot.title = element_text(hjust = 0.5, face = "bold"))
# Plot
# Summary statistics for lysis time
summary(lysis_data$lyse.time)
mean(lysis_data$lyse.time)
sd(lysis_data$lyse.time)
IQR(lysis_data$lyse.time)
min(lysis_data$lyse.time)
max(lysis_data$lyse.time)
# Q-Q plot for time to lysis (Infected treatment)
setwd("~/GitHub/VirosporeQuant/viro_attenuate")
# Load data
atten <- read.csv("~GitHub/VirosporeQuant/viro_attenuate/data/SPO1_attenuate.csv", header = TRUE, sep = ",", na.strings = "N/A")
setwd("~/GitHub/VirosporeQuant/viro_attenuate")
# Load data
atten <- read.csv("~GitHub/VirosporeQuant/viro_attenuate/data/SPO1_attenuate.csv", header = TRUE, sep = ",", na.strings = "N/A")
setwd("~/GitHub/VirosporeQuant/viro_attenuate")
# Load data
atten <- read.csv("~GitHub/VirosporeQuant/viro_attenuate/data/SPO1_attenuate.csv", header = TRUE, sep = ",", na.strings = "N/A")
# Load data
atten <- read.csv("~/GitHub/VirosporeQuant/viro_attenuate/data/SPO1_attenuate.csv", header = TRUE, sep = ",", na.strings = "N/A")
View(atten)
setwd("~/GitHub/VirosporeQuant/viro_attenuate")
# Load data
atten <- read.csv("~/GitHub/VirosporeQuant/viro_attenuate/data/SPO1_attenuate.csv", header = TRUE, sep = ",", na.strings = "N/A")
View(atten)
# Look at the data
hist(atten$Diameter_cm)
# Box plot of pre and post diameters
library(ggplot2)
ggplot(data = atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot()
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
library(ggplot2)
ggplot(resp, aes(x = site, y = Cumulative_Respiration)) +
geom_boxplot() +
theme_classic() +
xlab("Site") +
ylab("Cumulative Respiration (µg C-CO2 g-1 dry soil)") +
theme(text = element_text(size = 12))
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
geom_point() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
View(atten)
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
geom_jitter() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.6, size = 2) +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm, fill = pre_post_entrapment)) +
geom_boxplot(notch = TRUE) +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Box plot of pre and post diameters
library(ggplot2)
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm, fill = pre_post_entrapment)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm, fill = pre_post_entrapment)) +
geom_boxplot(notch = TRUE) +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Re order pre and post
# Define the desired order of categories
desired_order <- c("pre", "post")
# Reorder the factor levels
atten$pre_post_entrapment <- factor(atten$pre_post_entrapment, levels = desired_order)
# Create the box plot
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Re order pre and post
# Define the desired order of categories
desired_order <- c("pre", "post")
# Reorder the factor levels
atten$pre_post_entrapment <- factor(atten$pre_post_entrapment, levels = desired_order)
# Create the box plot
ggplot(atten, aes(x = pre_post_entrapment, y = Diameter_cm, fill = pre_post_entrapment)) +
geom_boxplot() +
theme_classic() +
xlab("Passage type") +
ylab("Plaque diameter (cm)") +
theme(text = element_text(size = 16))
# Is there a significant difference between pre and post?
# First check to see if the data is normal
shapiro.test(atten$Diameter_cm)
# Is there a significant difference between pre and post?
# First check to see if the data is normal
shapiro.test(atten$Diameter_cm) # no not at all
wilcox.test(Diameter_cm ~ pre_post_entrapment, data = atten)
# Is there a significant difference between pre and post?
# First check to see if the data is normal
shapiro.test(atten$Diameter_cm) # no not at all
wilcox.test(Diameter_cm ~ pre_post_entrapment, data = atten)
View(atten)
# Is there a significant difference between pre and post?
# First check to see if the data is normal
shapiro.test(atten$Diameter_cm) # no not at all
wilcox.test(Diameter_cm ~ pre_post_entrapment, data = atten)
