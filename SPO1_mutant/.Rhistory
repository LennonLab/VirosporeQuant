dev.off()
library(ggplot2)
svg("virospore.plot", width = 6, height = 4)
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", se = FALSE, size = 1) +
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "", # no need to include plot titles in publications
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +    # <<-- use classic theme instead of minimal
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
dev.off()
library(ggplot2)
svg("virospore.plot", width = 6, height = 4)
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "", # no need to include plot titles in publications
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +    # <<-- use classic theme instead of minimal
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
dev.off()
library(ggplot2)
svg("virospore_plot.svg", width = 6, height = 4)
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "", # no need to include plot titles in publications
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +    # <<-- use classic theme instead of minimal
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
dev.off()
library(ggplot2)
# Save as SVG
svg("virospore_plot.svg", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
getwd()
library(ggplot2)
# Save as SVG
svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot.svg", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot.svg", width = 8, height = 6)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_redpoint.svg", width = 8, height = 6)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "red", linetype = "dashed", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "red", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
#svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
pdf("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_red.pdf", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "red", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
#svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
pdf("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_red.pdf", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "red", size = 1) +  # straight line connecting points
geom_point(color = "red", size = 3) +
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
#svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
pdf("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_red.pdf", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "red", size = 1) +  # straight line connecting points
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
#svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
pdf("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_red.pdf", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "red", size = 1) +  # straight line connecting points
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
library(ggplot2)
# Save as SVG
#svg("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_reddash.svg", width = 8, height = 6)
pdf("~/GitHub/danger.signal/Magalie_virospore_quant/virospore_plot_red_green.pdf", width = 6, height = 4)
# Create the plot
ggplot(viro_quant_avg, aes(x = Distance_from_PFU_center_cm, y = mean_virospores)) +
geom_line(color = "#94f293", size = 1) +  # straight line connecting points
geom_vline(xintercept = c(0.05, 0.1),
linetype = "dashed", color = "darkgray", size = 0.8) +
geom_errorbar(aes(ymin = mean_virospores - SEM, ymax = mean_virospores + SEM),
width = 0.005, color = "black") +
geom_point(color = "red", size = 3) +
scale_fill_manual(values = c("Center" = "white", "Annulus" = "lightgray", "Lawn" = "darkgray")) +
scale_y_log10() +
labs(
title = "",
x = "Distance from center (cm)",
y = "Virospores (#/cm²)"
) +
theme_classic() +
coord_fixed(ratio = 0.1) +
theme(
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, vjust = 0.5)
)
# Close the device
dev.off()
setwd("~/GitHub/VirosporeQuant/SPO1_mutant")
data <- read_excel("~/GitHub/VirosporeQuant/SPO1_mutant/Data/20250819_1900_SPO1WT_mutant_data.xlsx", sheet = "annulus_data")
# Load Library
library(readxl)
library(dplyr)
library(tidyr)
library(vegan)
library(ggplot2)
library(mgcv)
data <- read_excel("~/GitHub/VirosporeQuant/SPO1_mutant/Data/20250819_1900_SPO1WT_mutant_data.xlsx", sheet = "annulus_data")
data <- read_excel("~/GitHub/VirosporeQuant/SPO1_mutant/Data/20250819_1900_SPO1WTmutant_data.xlsx", sheet = "annulus_data")
data <- read_excel("~/GitHub/VirosporeQuant/SPO1_mutant/Data/20250819_1900_SPO1WTmutant_annulus_data.xlsx", sheet = "annulus_data")
# Calculate vPFU of the original suspension which is # of PFU or CFU / vol plated x total dilution factor
data$vPFU_mL_2 <- data$vPFU_10e2/ (0.1 * (10^-2))
View(data)
# Calculate vPFU of the original suspension which is # of PFU or CFU / vol plated x total dilution factor
data$vPFU_mL_2 <- data$vPFU_10e2/ (0.1 * (10^-2))
data$vPFU_stock <- data$vPFU_mL_2 * 0.2
View(data)
# Calculate per area for virospores
data$vPFU_cm2 <- data$vPFU_stock / (0.00785)
View(data)
View(data)
head(data)
library(ggplot2)
# boxplot of vPFU_cm2 grouped by Genotype
ggplot(your_data, aes(x = Genotype, y = vPFU_cm2, fill = Genotype)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.7) + # add points
theme_minimal() +
labs(
title = "Distribution of vPFU/cm² by Genotype",
x = "Genotype",
y = "vPFU per cm²"
)
library(ggplot2)
# boxplot of vPFU_cm2 grouped by Genotype
ggplot(data, aes(x = Genotype, y = vPFU_cm2, fill = Genotype)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.7) + # add points
theme_minimal() +
labs(
title = "Distribution of vPFU/cm² by Genotype",
x = "Genotype",
y = "vPFU per cm²"
)
library(ggplot2)
# boxplot of vPFU_cm2 grouped by Genotype
ggplot(data, aes(x = Genotype, y = vPFU_cm2, fill = Genotype)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.7) + # add points
labs(
title = "Distribution of vPFU/cm² by Genotype",
x = "Genotype",
y = "vPFU per cm²"
)
library(paletteer)
library(ggplot2)
theme_set(theme_classic() +
theme(axis.title = element_text(size = 16),
axis.title.x = element_text(margin = margin(t = 15, b = 15)),
axis.title.y = element_text(margin = margin(l = 15, r = 15)),
axis.text = element_text(size = 13),
axis.text.x = element_text(margin = margin(t = 5)),
axis.text.y = element_text(margin = margin(r = 5)),
#axis.line.x = element_line(linewidth = 1),
#axis.line.y = element_line(linewidth = 1),
axis.ticks.y.right = element_line(linewidth = 1),
axis.text.y.right = element_text(size = 13, margin = margin(l = 5)),
axis.line.y.right = element_line(linewidth = 0.1),
axis.ticks.x.top = element_line(linewidth = 1),
axis.text.x.top = element_text(size = 13, margin = margin(b = 5)),
axis.line.x.top = element_line(linewidth = 0.1),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
axis.ticks.x = element_line(linewidth = 1),
axis.ticks.y = element_line(linewidth = 1),
axis.ticks.length = unit(.1, "in"),
panel.border = element_rect(color = "grey20", fill = NA, linewidth = 1.5),
legend.text = element_text(size = 14),
strip.text = element_text(size = 14),
strip.background = element_blank()
))
colors <-paletteer_d("ggthemes::Miller_Stone")
# Load Library
library(readxl)
library(dplyr)
library(tidyr)
library(vegan)
library(ggplot2)
library(mgcv)
data <- read_excel("~/GitHub/VirosporeQuant/SPO1_mutant/Data/20250819_1900_SPO1WTmutant_annulus_data.xlsx", sheet = "annulus_data")
# Calculate vPFU of the original suspension which is # of PFU or CFU / vol plated x total dilution factor
data$vPFU_mL_2 <- data$vPFU_10e2/ (0.1 * (10^-2))
# Accounting for the stock amount (the amount of liquid that the virospores were deposited into in mL)
data$vPFU_stock <- data$vPFU_mL_2 * 0.2
# Calculate per area for virospores
data$vPFU_cm2 <- data$vPFU_stock / (0.00785)
library(ggplot2)
# boxplot of vPFU_cm2 grouped by Genotype
ggplot(data, aes(x = Genotype, y = vPFU_cm2, fill = Genotype)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.7) + # add points
labs(
title = "Distribution of vPFU/cm² by Genotype",
x = "Genotype",
y = "vPFU per cm²"
)
library(ggplot2)
# boxplot of vPFU_cm2 grouped by Genotype
ggplot(data, aes(x = Genotype, y = vPFU_cm2, fill = Genotype)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.7) + # add points
labs(
title = "",
x = "Genotype",
y = "vPFU per cm²"
)
# Running stats test
# Check to see if data is normal
shapiro.test(data$vPFU_cm2)
# Running stats test
# Check to see if data is normal
shapiro.test(data$vPFU_cm2) #p value = 0.02 indicating that data is normally distributed
t.test(vPFU_cm2 ~ Genotype, data = data)
library(ggplot2)
data$Genotype <- factor(data$Genotype, levels = c("wildtype", "mutant"))
# boxplot of vPFU_cm2 grouped by Genotype
ggplot(data, aes(x = Genotype, y = vPFU_cm2, fill = Genotype)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.7) + # add points
labs(
title = "",
x = "Genotype",
y = "vPFU per cm²"
)
